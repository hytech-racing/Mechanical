#include "rtwtypes.h"
#include "multiword_types.h"
#include "mwmathutil.h"
#include "PadeApproximantOfDegree_5BLwCIn6.h"

void PadeApproximantOfDegree_5BLwCIn6(const real_T A[4], uint8_T m, real_T F[4])
{
  real_T A2[4];
  real_T A3[4];
  real_T A4[4];
  real_T A4_p[4];
  real_T U[4];
  real_T V[4];
  real_T A4_idx_2;
  real_T A4_idx_3;
  real_T a22;
  real_T d;
  int32_T r1;
  int32_T r2;
  for (r1 = 0; r1 < 2; r1++) {
    A2[r1 << 1] = 0.0;
    A2[r1 << 1] += A[r1 << 1] * A[0];
    A2[r1 << 1] += A[(r1 << 1) + 1] * A[2];
    A2[(r1 << 1) + 1] = 0.0;
    A2[(r1 << 1) + 1] += A[r1 << 1] * A[1];
    A2[(r1 << 1) + 1] += A[(r1 << 1) + 1] * A[3];
  }

  if (m == 3) {
    U[1] = A2[1];
    U[2] = A2[2];
    U[0] = A2[0] + 60.0;
    U[3] = A2[3] + 60.0;
    for (r1 = 0; r1 < 2; r1++) {
      A4_p[r1 << 1] = 0.0;
      A4_p[r1 << 1] += U[r1 << 1] * A[0];
      A4_p[r1 << 1] += U[(r1 << 1) + 1] * A[2];
      A4_p[(r1 << 1) + 1] = 0.0;
      A4_p[(r1 << 1) + 1] += U[r1 << 1] * A[1];
      A4_p[(r1 << 1) + 1] += U[(r1 << 1) + 1] * A[3];
    }

    U[0] = A4_p[0];
    V[0] = 12.0 * A2[0];
    U[1] = A4_p[1];
    V[1] = 12.0 * A2[1];
    U[2] = A4_p[2];
    V[2] = 12.0 * A2[2];
    U[3] = A4_p[3];
    V[3] = 12.0 * A2[3];
    d = 120.0;
  } else {
    for (r1 = 0; r1 < 2; r1++) {
      A3[r1 << 1] = 0.0;
      A3[r1 << 1] += A2[r1 << 1] * A2[0];
      A3[r1 << 1] += A2[(r1 << 1) + 1] * A2[2];
      A3[(r1 << 1) + 1] = 0.0;
      A3[(r1 << 1) + 1] += A2[r1 << 1] * A2[1];
      A3[(r1 << 1) + 1] += A2[(r1 << 1) + 1] * A2[3];
    }

    if (m == 5) {
      U[0] = 420.0 * A2[0] + A3[0];
      U[1] = 420.0 * A2[1] + A3[1];
      U[2] = 420.0 * A2[2] + A3[2];
      U[3] = 420.0 * A2[3] + A3[3];
      U[0] += 15120.0;
      U[3] += 15120.0;
      for (r1 = 0; r1 < 2; r1++) {
        A4_p[r1 << 1] = 0.0;
        A4_p[r1 << 1] += U[r1 << 1] * A[0];
        A4_p[r1 << 1] += U[(r1 << 1) + 1] * A[2];
        A4_p[(r1 << 1) + 1] = 0.0;
        A4_p[(r1 << 1) + 1] += U[r1 << 1] * A[1];
        A4_p[(r1 << 1) + 1] += U[(r1 << 1) + 1] * A[3];
      }

      U[0] = A4_p[0];
      V[0] = 30.0 * A3[0] + 3360.0 * A2[0];
      U[1] = A4_p[1];
      V[1] = 30.0 * A3[1] + 3360.0 * A2[1];
      U[2] = A4_p[2];
      V[2] = 30.0 * A3[2] + 3360.0 * A2[2];
      U[3] = A4_p[3];
      V[3] = 30.0 * A3[3] + 3360.0 * A2[3];
      d = 30240.0;
    } else {
      for (r1 = 0; r1 < 2; r1++) {
        A4[r1 << 1] = 0.0;
        A4[r1 << 1] += A2[r1 << 1] * A3[0];
        A4[r1 << 1] += A2[(r1 << 1) + 1] * A3[2];
        A4[(r1 << 1) + 1] = 0.0;
        A4[(r1 << 1) + 1] += A2[r1 << 1] * A3[1];
        A4[(r1 << 1) + 1] += A2[(r1 << 1) + 1] * A3[3];
      }

      if (m == 7) {
        U[0] = (1512.0 * A3[0] + A4[0]) + 277200.0 * A2[0];
        U[1] = (1512.0 * A3[1] + A4[1]) + 277200.0 * A2[1];
        U[2] = (1512.0 * A3[2] + A4[2]) + 277200.0 * A2[2];
        U[3] = (1512.0 * A3[3] + A4[3]) + 277200.0 * A2[3];
        U[0] += 8.64864E+6;
        U[3] += 8.64864E+6;
        for (r1 = 0; r1 < 2; r1++) {
          A4_p[r1 << 1] = 0.0;
          A4_p[r1 << 1] += U[r1 << 1] * A[0];
          A4_p[r1 << 1] += U[(r1 << 1) + 1] * A[2];
          A4_p[(r1 << 1) + 1] = 0.0;
          A4_p[(r1 << 1) + 1] += U[r1 << 1] * A[1];
          A4_p[(r1 << 1) + 1] += U[(r1 << 1) + 1] * A[3];
        }

        U[0] = A4_p[0];
        V[0] = (56.0 * A4[0] + 25200.0 * A3[0]) + 1.99584E+6 * A2[0];
        U[1] = A4_p[1];
        V[1] = (56.0 * A4[1] + 25200.0 * A3[1]) + 1.99584E+6 * A2[1];
        U[2] = A4_p[2];
        V[2] = (56.0 * A4[2] + 25200.0 * A3[2]) + 1.99584E+6 * A2[2];
        U[3] = A4_p[3];
        V[3] = (56.0 * A4[3] + 25200.0 * A3[3]) + 1.99584E+6 * A2[3];
        d = 1.729728E+7;
      } else if (m == 9) {
        for (r1 = 0; r1 < 2; r1++) {
          V[r1 << 1] = 0.0;
          V[r1 << 1] += A2[r1 << 1] * A4[0];
          V[r1 << 1] += A2[(r1 << 1) + 1] * A4[2];
          V[(r1 << 1) + 1] = 0.0;
          V[(r1 << 1) + 1] += A2[r1 << 1] * A4[1];
          V[(r1 << 1) + 1] += A2[(r1 << 1) + 1] * A4[3];
        }

        U[0] = ((3960.0 * A4[0] + V[0]) + 2.16216E+6 * A3[0]) + 3.027024E+8 *
          A2[0];
        U[1] = ((3960.0 * A4[1] + V[1]) + 2.16216E+6 * A3[1]) + 3.027024E+8 *
          A2[1];
        U[2] = ((3960.0 * A4[2] + V[2]) + 2.16216E+6 * A3[2]) + 3.027024E+8 *
          A2[2];
        U[3] = ((3960.0 * A4[3] + V[3]) + 2.16216E+6 * A3[3]) + 3.027024E+8 *
          A2[3];
        U[0] += 8.8216128E+9;
        U[3] += 8.8216128E+9;
        for (r1 = 0; r1 < 2; r1++) {
          A4_p[r1 << 1] = 0.0;
          A4_p[r1 << 1] += U[r1 << 1] * A[0];
          A4_p[r1 << 1] += U[(r1 << 1) + 1] * A[2];
          A4_p[(r1 << 1) + 1] = 0.0;
          A4_p[(r1 << 1) + 1] += U[r1 << 1] * A[1];
          A4_p[(r1 << 1) + 1] += U[(r1 << 1) + 1] * A[3];
        }

        U[0] = A4_p[0];
        V[0] = ((90.0 * V[0] + 110880.0 * A4[0]) + 3.027024E+7 * A3[0]) +
          2.0756736E+9 * A2[0];
        U[1] = A4_p[1];
        V[1] = ((90.0 * V[1] + 110880.0 * A4[1]) + 3.027024E+7 * A3[1]) +
          2.0756736E+9 * A2[1];
        U[2] = A4_p[2];
        V[2] = ((90.0 * V[2] + 110880.0 * A4[2]) + 3.027024E+7 * A3[2]) +
          2.0756736E+9 * A2[2];
        U[3] = A4_p[3];
        V[3] = ((90.0 * V[3] + 110880.0 * A4[3]) + 3.027024E+7 * A3[3]) +
          2.0756736E+9 * A2[3];
        d = 1.76432256E+10;
      } else {
        U[0] = (3.352212864E+10 * A4[0] + 1.05594705216E+13 * A3[0]) +
          1.1873537964288E+15 * A2[0];
        U[1] = (3.352212864E+10 * A4[1] + 1.05594705216E+13 * A3[1]) +
          1.1873537964288E+15 * A2[1];
        U[2] = (3.352212864E+10 * A4[2] + 1.05594705216E+13 * A3[2]) +
          1.1873537964288E+15 * A2[2];
        U[3] = (3.352212864E+10 * A4[3] + 1.05594705216E+13 * A3[3]) +
          1.1873537964288E+15 * A2[3];
        U[0] += 3.238237626624E+16;
        U[3] += 3.238237626624E+16;
        d = (16380.0 * A3[0] + A4[0]) + 4.08408E+7 * A2[0];
        a22 = (16380.0 * A3[1] + A4[1]) + 4.08408E+7 * A2[1];
        A4_idx_2 = (16380.0 * A3[2] + A4[2]) + 4.08408E+7 * A2[2];
        A4_idx_3 = (16380.0 * A3[3] + A4[3]) + 4.08408E+7 * A2[3];
        for (r1 = 0; r1 < 2; r1++) {
          A4_p[r1] = (A4[r1 + 2] * a22 + A4[r1] * d) + U[r1];
          A4_p[r1 + 2] = (A4[r1 + 2] * A4_idx_3 + A4[r1] * A4_idx_2) + U[r1 + 2];
        }

        d = (182.0 * A4[0] + 960960.0 * A3[0]) + 1.32324192E+9 * A2[0];
        a22 = (182.0 * A4[1] + 960960.0 * A3[1]) + 1.32324192E+9 * A2[1];
        A4_idx_2 = (182.0 * A4[2] + 960960.0 * A3[2]) + 1.32324192E+9 * A2[2];
        A4_idx_3 = (182.0 * A4[3] + 960960.0 * A3[3]) + 1.32324192E+9 * A2[3];
        for (r1 = 0; r1 < 2; r1++) {
          U[r1 << 1] = 0.0;
          U[r1 << 1] += A4_p[r1 << 1] * A[0];
          U[r1 << 1] += A4_p[(r1 << 1) + 1] * A[2];
          U[(r1 << 1) + 1] = 0.0;
          U[(r1 << 1) + 1] += A4_p[r1 << 1] * A[1];
          U[(r1 << 1) + 1] += A4_p[(r1 << 1) + 1] * A[3];
          V[r1] = (((A4[r1 + 2] * a22 + A4[r1] * d) + 6.704425728E+11 * A4[r1])
                   + 1.29060195264E+14 * A3[r1]) + 7.7717703038976E+15 * A2[r1];
          V[r1 + 2] = (((A4[r1 + 2] * A4_idx_3 + A4[r1] * A4_idx_2) + A4[r1 + 2]
                        * 6.704425728E+11) + A3[r1 + 2] * 1.29060195264E+14) +
            A2[r1 + 2] * 7.7717703038976E+15;
        }

        d = 6.476475253248E+16;
      }
    }
  }

  V[0] += d;
  V[0] -= U[0];
  U[0] *= 2.0;
  V[1] -= U[1];
  U[1] *= 2.0;
  V[2] -= U[2];
  U[2] *= 2.0;
  V[3] = (V[3] + d) - U[3];
  U[3] *= 2.0;
  if (muDoubleScalarAbs(V[1]) > muDoubleScalarAbs(V[0])) {
    r1 = 1;
    r2 = 0;
  } else {
    r1 = 0;
    r2 = 1;
  }

  d = V[r2] / V[r1];
  a22 = V[r2 + 2] - V[r1 + 2] * d;
  F[1] = (U[r2] - U[r1] * d) / a22;
  F[0] = (U[r1] - V[r1 + 2] * F[1]) / V[r1];
  F[3] = (U[r2 + 2] - U[r1 + 2] * d) / a22;
  F[2] = (U[r1 + 2] - V[r1 + 2] * F[3]) / V[r1];
  F[0]++;
  F[3]++;
}
